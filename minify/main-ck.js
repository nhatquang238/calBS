// mock data
var events=[{date:"2013-10-19",allEvents:[{title:"Red",location:"SMU",time:"8:00AM"}]},{date:"2013-10-23",allEvents:[{title:"Red",location:"SMU",time:"8:00AM"},{title:"Green",location:"Kallang",time:"12:00PM"},{title:"Blue",location:"SMU",time:"16:00PM"}]},{date:"2013-10-25",allEvents:[{title:"Red",location:"SMU",time:"8:00AM"},{title:"Green",location:"City Hall",time:"12:00PM"}]},{date:"2013-10-28",allEvents:[{title:"Red",location:"SMU",time:"8:00AM"},{title:"Green",location:"SMU",time:"12:00PM"},{title:"Blue",location:"SMU",time:"16:00PM"},{title:"Yellow",location:"Bugis",time:"19:00PM"},{title:"Orange",location:"Home",time:"21:00PM"}]},{date:"2013-10-31",allEvents:[{title:"Green",location:"SMU",time:"12:00PM"},{title:"Blue",location:"SMU",time:"16:00PM"},{title:"Yellow",location:"Raffles City",time:"19:00PM"},{title:"Orange",location:"Dhoby Ghaut",time:"21:00PM"}]}],resultsTemplate=_.template($("#results-template").html()),resultsTemplateData={events:events};$(".results").append(resultsTemplate(resultsTemplateData));$(".event-calendar").clndr({template:$("#calendar-template").html(),startWithMonth:moment(),daysOfTheWeek:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],events:events,clickEvents:{click:function(e){$(".today").removeClass("today");$(e.element).addClass("today")}},doneRendering:function(){},extras:{}});var searchQuery=[];_.each(events,function(e){_.each(e.allEvents,function(e){_.indexOf(searchQuery,e.title)==-1&&searchQuery.push(e.title)})});var searchTemplate=_.template($("#searchbox-template").html()),searchTemplateData={queries:searchQuery};$("#searchbox").append(searchTemplate(searchTemplateData));var $events=$(".results .event"),$days=$(".results .date"),$calendarDays=$(".clndr-grid .day");$("#searchbox").chosen({disable_search_threshold:5,no_results_text:"Oops, no activity found!",width:"100%"}).change(function(){var e=$("#searchbox").val();if(e==null){$events.removeClass("hide");$days.removeClass("hide");$calendarDays.removeClass("blur-day")}else{$events.removeClass("hide");$days.removeClass("hide");$calendarDays.removeClass("blur-day");unselectedActivities=_.difference(searchQuery,e);_.each(unselectedActivities,function(e){$("."+e).addClass("hide")});$days.each(function(){var e=!1;$(this).find(".event").each(function(){if(!$(this).hasClass("hide")){e=!1;return!1}e=!0});e==1&&$(this).addClass("hide")})}});